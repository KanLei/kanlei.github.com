---
layout: post
title: "拜占庭将军问题与共识算法"
description: ""
category: 
tags: [blockchain]
---
{% include JB/setup %}


### 内容简介

本文主要解释了什么是拜占庭将军问题，以及如何解决拜占庭将军问题；什么是共识算法，不同共识算法之间的区别是什么。

### 两个将军问题

在介绍拜占庭将军问题之前，我们先来了解一下两个将军问题。

> 两只军队驻扎在山谷的两侧，他们共同的敌人则驻扎在山谷的中间，两个将军必须带领军队同时出击方能击败山谷中的敌军，只有一方进军则必定失败。两个将军之间交流完全依赖于信使，且山谷是信使们传递消息的必经之路，那么两个将军攻击敌人的时间达成一致呢？

在计算机网络中中，该问题被描述为，两个结点在不安全的信道环境下如何达成一致？最终，两个将军问题被证明是无法解决的问题，由于通信链路的不安全性，无法保证多个实体间的最终一致性。

### 拜占庭将军问题

拜占庭将军问题则是在两个将军问题之上的延伸，首先，拜占庭将军问题假设信道是安全的，而将军中有可能出现叛徒。问题描述如下：

> 一组拜占庭将军率领军队围困一座城堡，只有当 n/2 + 1 位将军共同出击才能击败城堡中的敌军，否则即为失败。将军中存在叛徒，叛徒可能会传递假的消息给其他的将军。如何保证最终的攻击不会失败？

在分布式计算中，该问题被描述为不同的结点之间通过交换信息达成共识，而当结点发生错误或者传递出错误消息时，如何才能保证整个系统的一致性？


### POW

POW(Proof of Work)是比特币系统给出的解决共识问题的方案。在比特币系统中，Satoshi Nakamoto 提出了一种让所有计算结点通过消耗计算资源完成一道计算题目，从而提升结点伪造的困难度，前提是假设全网中诚实的结点掌握着绝大多数算力，否则即会出现 51% 攻击。

首先比特币网络中的某一个结点生成一笔交易并广播到全网，同时挖矿结点在不断接收来自网络上的交易，验证交易合法性之后会将它们添加到一个区块中，当区块的数据量达到1M时，结点会通过消耗计算资源得到一个HASH值用于表示自己的工作量，接着将该区块传播给全网，网络中的其它结点接收到该区块并校验，验证通过后则将其链接到当前的链上，从而构成了一条由区块链接而成的区块链。

##### 双花问题

双花问题即一笔交易被花费两次。在比特币之前也存在一些电子现金货币的尝试，但都依赖于中心机构来保证不会出现双花问题，而比特币提出了一种以去中心化的方式保证双花问题。比特币通过对每个区块中增加时间戳，来保证时间最早的交易才是有效的花费。

##### 分叉问题

由于挖矿是由全网结点共同进行的，因此难免会出现某一时刻不同的挖矿结点会同时挖出最新的区块，并广播给网络中的其余结点，这时就形成了分叉。比特币系统采用的方案时，所有的结点会自动切换到工作量最多的链上，即最长的分叉，由于两条分叉上的算力不是平衡的，所以最终保证只有最长的一条链有效。

#### 51% 攻击

#### 存储容量

#### 交易速度

### dBFT



[*Two Generals' Problem*](https://en.wikipedia.org/wiki/Two_Generals%27_Problem)  
[*Byzantine fault tolerance*](https://en.wikipedia.org/wiki/Byzantine_fault_tolerance#Byzantine_Generals'_Problem)  
[*Bitcoin*](https://bitcoin.org/bitcoin.pdf)  
[*dBFT*](https://steemit.com/neo/@basiccrypto/neo-s-consensus-protocol-how-delegated-byzantine-fault-tolerance-works)